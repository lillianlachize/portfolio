<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/x-icon" href="iconne.ico" />
    <title>CV - Lillian Lachize | BTS SIO</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .difficulty-selector {
            margin-bottom: 15px;
            display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;
        }
        .btn-diff {
            background-color: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 8px 15px; border-radius: 20px;
            cursor: pointer; font-family: 'Segoe UI', sans-serif;
            font-size: 0.9rem; transition: all 0.3s ease;
            text-transform: uppercase; font-weight: bold;
        }
        .btn-diff:hover { background-color: rgba(0, 212, 255, 0.1); transform: translateY(-2px); }
        
        .btn-diff.selected {
            background-color: var(--primary-color);
            color: #1e1e2f; box-shadow: 0 0 10px var(--primary-color);
        }
        /* Style sp√©cifique Extreme */
        .btn-diff[data-level="extreme"].selected {
            background-color: #ff0055; border-color: #ff0055; color: white; box-shadow: 0 0 15px #ff0055;
        }
        /* Style sp√©cifique 1 vs 1 */
        .btn-diff[data-level="pvp"].selected {
            background-color: #fff; border-color: #fff; color: #000; box-shadow: 0 0 15px #fff;
        }
    </style>
</head>
<body>

    <header>
        <img src="photo-LillianV2.png" alt="Photo de Lillian Lachize" class="profile-photo">
        <h1>Lillian Lachize</h1>
        <div class="subtitle">√âtudiant en BTS SIO - R√©seaux & Cybers√©curit√©</div>
        <div class="alert-box">
            üöÄ √Ä la recherche de connaissances, <br> principalement dans le milieu informatique afin d'√©toffer mes comp√©tences.
        </div>
        <div class="contact-info">
            <span>üìç Montmerle sur Sa√¥ne (01090)</span>
            <span>üìß <a href="mailto:lillianlachize.fr@gmail.com">lillianlachize.fr@gmail.com</a></span>
            <span>üìû 07.67.98.51.58</span>
            <span>üîó <a href="https://www.linkedin.com/in/lillian-lachize/" target="_blank">Mon LinkedIn</a></span>
        </div>
    </header>

    <div class="container">

        <section class="section">
            <h2>üõ† Comp√©tences Techniques</h2>
            <div class="grid-2">
                <div>
                    <h3>Syst√®mes & R√©seaux</h3>
                    <p>
                        <span class="skill-tag">Windows Server</span>
                        <span class="skill-tag">Linux</span>
                        <span class="skill-tag">Virtual code / sublimetext </span>
                        <span class="skill-tag">Microsoft 365</span>
                        <span class="skill-tag">VPN (Ipfire)</span>
                        <span class="skill-tag">Virtualisation (VMware)</span>
                    </p>
                </div>
                <div>
                    <h3>D√©veloppement & Outils</h3>
                    <p>
                        <span class="skill-tag">HTML5 / CSS3</span>
                        <span class="skill-tag">Python 3</span>
                        <span class="skill-tag">PHP</span>
                        <span class="skill-tag">SQL</span>
                        <span class="skill-tag">Git / GitHub</span>
                    </p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>üéì Formations</h2>
            <div class="timeline-item">
                <div class="job-title">BTS SIO (Services Informatiques aux Organisations)</div>
                <div class="date">Septembre 2025 - Aujourd'hui</div>
                <div><em>Centre Scolaire Notre Dame, Limas</em></div>
                <p>Sp√©cialisation : Serveur Windows/Linux, Cybers√©curit√©, R√©seaux, D√©veloppement.</p>
            </div>
            <div class="timeline-item">
                <div class="job-title">Baccalaur√©at Technologique STI2D</div>
                <div class="date">2022 - 2024</div>
                <div><em>Lyc√©e Louis Armand, Villefranche</em></div>
                <p>Sp√©cialit√©s : R√©seaux informatiques, D√©veloppement Web, Python (IHM), Maths/Physique.</p>
            </div>
            <div class="timeline-item">
                <div class="job-title">Autodidacte & Certifications</div>
                <div class="date">2024</div>
                <p>‚Ä¢ <strong>Dipl√¥me PIX</strong> ‚Ä¢ <strong>OpenClassrooms</strong> (HTML/CSS, PHP, Python, Git).</p>
            </div>
        </section>

        <section class="section">
            <h2>üíº Exp√©riences Professionnelles</h2>
            <div class="timeline-item">
                <div class="job-title">Employ√© Polyvalent (Boucherie/Rayon)</div>
                <div class="date">16/04/2025 au 31/08/2025 | Intermarch√©</div>
                <p>Gestion des stocks, mise en rayon.</p>
            </div>
            <div class="timeline-item">
                <div class="job-title">Employ√© Polyvalent (Bricolage)</div>
                <div class="date">24/02/2025 au 15/03/2025 | Bricomarch√©</div>
                <p>Mise en rayon, gestion des stocks, relation client.</p>
            </div>
            <div class="timeline-item">
                <div class="job-title">Stage D√©couverte Web & S√©curit√©</div>
                <div class="date">F√©vrier 2021 | PMP Concept</div>
                <p>Programmation et s√©curisation web (HTML/CSS/PHP).</p>
            </div>
        </section>

        <section class="section">
            <h2>üöÄ Projets & Centres d'Int√©r√™t</h2>
            <div class="grid-2">
                <div>
                    <h3>Projets Personnels</h3>
                    <ul>
                        <li>D√©veloppement de jeux vid√©o.</li>
                        <li>Cr√©ation et animation en Pixel Art.</li>
                        <li>Chiffrement de fichiers.</li>
                    </ul>
                </div>
                <div>
                    <h3>Loisirs & Sports</h3>
                    <ul>
                        <li><strong>Arts Martiaux (Kali, AITO) :</strong> Objectif ceinture noire.</li>
                        <li>Veille technologique.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="section" style="text-align: center;">
            <h2>üßÆ Projet TP : La Calculatrice</h2>
            <p style="margin-bottom: 20px;">R√©alisation d'une calculatrice graphique via un tableau HTML.</p>
            <table class="calculatrice">
                <tr><td colspan="4" class="ecran">0</td></tr>
                <tr><td class="chiffre">1</td><td class="chiffre">2</td><td class="chiffre">3</td><td class="operateur">+</td></tr>
                <tr><td class="chiffre">4</td><td class="chiffre">5</td><td class="chiffre">6</td><td class="operateur">-</td></tr>
                <tr><td class="chiffre">7</td><td class="chiffre">8</td><td class="chiffre">9</td><td class="operateur">&times;</td></tr>
                <tr><td class="chiffre">0</td><td class="autre">(</td><td class="autre">)</td><td class="operateur">&divide;</td></tr>
                <tr><td class="autre">&larr;</td><td class="autre">.</td><td colspan="2" class="egal">=</td></tr>
            </table>
        </section>

        <section class="section" style="text-align: center; position: relative;">
            <h2>‚ôû Projet TP : Jeu d'√âchecs vs IA</h2>
            <p style="margin-bottom: 10px;">Choisissez votre niveau de difficult√© ou jouez √† deux :</p>
            
            <div class="difficulty-selector">
                <button class="btn-diff" data-level="pvp" title="Jouer sans IA (Humain vs Humain)">1 vs 1</button>
                <button class="btn-diff" data-level="facile">Facile</button>
                <button class="btn-diff selected" data-level="normal">Normal</button>
                <button class="btn-diff" data-level="difficile">Difficile</button>
                <button class="btn-diff" data-level="extreme">Extr√™me</button>
            </div>

            <div class="info-tour">Tour actuel : <span id="tour-indicateur">BLANCS</span></div>

            <table class="echiquier" id="plateau">
                <tr>
                    <td><div class="piece noir tour" data-type="tour" data-couleur="noir"></div></td>
                    <td><div class="piece noir cavalier" data-type="cavalier" data-couleur="noir"></div></td>
                    <td><div class="piece noir fou" data-type="fou" data-couleur="noir"></div></td>
                    <td><div class="piece noir reine" data-type="reine" data-couleur="noir"></div></td>
                    <td><div class="piece noir roi" data-type="roi" data-couleur="noir"></div></td>
                    <td><div class="piece noir fou" data-type="fou" data-couleur="noir"></div></td>
                    <td><div class="piece noir cavalier" data-type="cavalier" data-couleur="noir"></div></td>
                    <td><div class="piece noir tour" data-type="tour" data-couleur="noir"></div></td>
                </tr>
                <tr>
                    <td><div class="piece noir pion" data-type="pion" data-couleur="noir"></div></td>
                    <td><div class="piece noir pion" data-type="pion" data-couleur="noir"></div></td>
                    <td><div class="piece noir pion" data-type="pion" data-couleur="noir"></div></td>
                    <td><div class="piece noir pion" data-type="pion" data-couleur="noir"></div></td>
                    <td><div class="piece noir pion" data-type="pion" data-couleur="noir"></div></td>
                    <td><div class="piece noir pion" data-type="pion" data-couleur="noir"></div></td>
                    <td><div class="piece noir pion" data-type="pion" data-couleur="noir"></div></td>
                    <td><div class="piece noir pion" data-type="pion" data-couleur="noir"></div></td>
                </tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr>
                    <td><div class="piece blanc pion" data-type="pion" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc pion" data-type="pion" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc pion" data-type="pion" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc pion" data-type="pion" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc pion" data-type="pion" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc pion" data-type="pion" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc pion" data-type="pion" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc pion" data-type="pion" data-couleur="blanc"></div></td>
                </tr>
                <tr>
                    <td><div class="piece blanc tour" data-type="tour" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc cavalier" data-type="cavalier" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc fou" data-type="fou" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc reine" data-type="reine" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc roi" data-type="roi" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc fou" data-type="fou" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc cavalier" data-type="cavalier" data-couleur="blanc"></div></td>
                    <td><div class="piece blanc tour" data-type="tour" data-couleur="blanc"></div></td>
                </tr>
            </table>
        </section>

    </div> <footer>
        <p>
            &copy; 2025 Lillian Lachize - 
            <a href="https://www.linkedin.com/in/lillian-lachize/" target="_blank">Me retrouver sur LinkedIn</a>
        </p>
    </footer>

    <div id="ecran-victoire" class="modal-victoire">
        <div class="contenu-victoire">
            <h2 id="texte-victoire">VICTOIRE !</h2>
            <p>La partie est termin√©e.</p>
            <button class="bouton-rejouer" onclick="location.reload()">REJOUER</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- CONFIGURATION GEMINI ---
            const GEMINI_API_KEY = "AIzaSyCsyKj4g5YjSp5kXtkrSKhuR2Ypi5Blv_A"; 
            const GEMINI_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;

            /* =========================================
               0. GESTION DE LA DIFFICULT√â
               ========================================= */
            let niveauDifficulte = 'normal';
            
            const boutonsDifficulte = document.querySelectorAll('.btn-diff');
            boutonsDifficulte.forEach(btn => {
                btn.addEventListener('click', function() {
                    boutonsDifficulte.forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    niveauDifficulte = this.getAttribute('data-level');
                    console.log("Mode choisi : " + niveauDifficulte);
                });
            });

            /* =========================================
               1. LOGIQUE DE LA CALCULATRICE
               ========================================= */
            const ecran = document.querySelector('.ecran');
            document.querySelectorAll('table.calculatrice td').forEach(touche => {
                touche.addEventListener('click', function() {
                    if (this.classList.contains('ecran')) return;
                    const val = this.innerText;
                    if (this.classList.contains('egal')) {
                        try { ecran.innerText = eval(ecran.innerText.replace(/√ó/g, '*').replace(/√∑/g, '/')); } 
                        catch { ecran.innerText = "Erreur"; }
                    } else if (val === '‚Üê') {
                        ecran.innerText = ecran.innerText.slice(0, -1) || '0';
                    } else {
                        ecran.innerText = (ecran.innerText === '0' || ecran.innerText === 'Erreur') ? val : ecran.innerText + val;
                    }
                });
            });

            /* =========================================
               2. LOGIQUE JEU D'√âCHECS (CORE)
               ========================================= */
            
            let tourActuel = 'blanc'; 
            let caseSelectionnee = null;
            let jeuFini = false;
            let iaReflechit = false; 
            
            const indicateurTour = document.getElementById('tour-indicateur');
            const cases = Array.from(document.querySelectorAll('.echiquier td')); 
            const ecranVictoire = document.getElementById('ecran-victoire');
            const texteVictoire = document.getElementById('texte-victoire');

            // --- Utilitaires ---
            function getCoords(td) {
                const index = cases.indexOf(td);
                return { x: index % 8, y: Math.floor(index / 8) };
            }

            function getCaseAt(x, y) {
                if (x < 0 || x > 7 || y < 0 || y > 7) return null;
                return cases[y * 8 + x];
            }

            function getNotation(index) {
                const x = index % 8;
                const y = Math.floor(index / 8);
                const col = String.fromCharCode(97 + x); 
                const row = 8 - y; 
                return col + row;
            }

            function checkCheminLibre(pos1, pos2) {
                const stepX = Math.sign(pos2.x - pos1.x);
                const stepY = Math.sign(pos2.y - pos1.y);
                let currentX = pos1.x + stepX;
                let currentY = pos1.y + stepY;
                while (currentX !== pos2.x || currentY !== pos2.y) {
                    if (getCaseAt(currentX, currentY).querySelector('.piece')) return false; 
                    currentX += stepX;
                    currentY += stepY;
                }
                return true;
            }

            // --- FEN Generator (Pour la Vision IA) ---
            function genererFEN() {
                let fen = "";
                for (let y = 0; y < 8; y++) {
                    let emptyCount = 0;
                    for (let x = 0; x < 8; x++) {
                        const td = getCaseAt(x, y);
                        const piece = td.querySelector('.piece');
                        if (!piece) {
                            emptyCount++;
                        } else {
                            if (emptyCount > 0) { fen += emptyCount; emptyCount = 0; }
                            const type = piece.getAttribute('data-type');
                            const color = piece.getAttribute('data-couleur');
                            let char = '';
                            switch(type) {
                                case 'tour': char = 'r'; break;
                                case 'cavalier': char = 'n'; break;
                                case 'fou': char = 'b'; break;
                                case 'reine': char = 'q'; break;
                                case 'roi': char = 'k'; break;
                                case 'pion': char = 'p'; break;
                            }
                            if (color === 'blanc') char = char.toUpperCase();
                            fen += char;
                        }
                    }
                    if (emptyCount > 0) fen += emptyCount;
                    if (y < 7) fen += "/";
                }
                fen += " b - - 0 1";
                return fen;
            }

            // --- Gestionnaire de Clics ---
            cases.forEach(td => {
                td.addEventListener('click', function() {
                    // Si le jeu est fini ou si l'IA r√©fl√©chit, on bloque
                    if (jeuFini || iaReflechit) return;

                    // Si c'est aux Noirs de jouer, on bloque SAUF si on est en mode "PvP"
                    if (tourActuel === 'noir' && niveauDifficulte !== 'pvp') return;

                    const pieceSurCase = this.querySelector('.piece');
                    
                    // S√âLECTION
                    if (!caseSelectionnee) {
                        // On doit pouvoir s√©lectionner une pi√®ce de SA couleur actuelle
                        if (pieceSurCase && pieceSurCase.getAttribute('data-couleur') === tourActuel) {
                            selectionnerCase(this);
                        }
                    } 
                    // ACTION (D√©placement ou Changement s√©lection)
                    else {
                        if (caseSelectionnee === this) { resetSelection(); return; }
                        
                        // Si on clique sur une autre pi√®ce de SA couleur -> Changement de s√©lection
                        if (pieceSurCase && pieceSurCase.getAttribute('data-couleur') === tourActuel) {
                            resetSelection();
                            selectionnerCase(this);
                            return;
                        }

                        // D√©placement valide
                        if (estCoupValide(caseSelectionnee, this)) {
                            effectuerDeplacement(caseSelectionnee, this);
                            if (!jeuFini) {
                                changerTour(); 
                                // On ne d√©clenche l'IA que si on n'est PAS en mode PvP
                                if (niveauDifficulte !== 'pvp') {
                                    setTimeout(jouerIA_Manager, 100); 
                                }
                            }
                        }
                        resetSelection();
                    }
                });
            });

            function selectionnerCase(td) {
                caseSelectionnee = td;
                td.classList.add('case-selected');
                montrerCoupsPossibles(td);
            }

            function resetSelection() {
                cases.forEach(c => { c.classList.remove('case-selected'); c.classList.remove('coup-possible'); });
                caseSelectionnee = null;
            }

            function montrerCoupsPossibles(depart) {
                cases.forEach(arrivee => {
                    if (arrivee !== depart && estCoupValide(depart, arrivee)) {
                        arrivee.classList.add('coup-possible');
                    }
                });
            }

            function changerTour() {
                tourActuel = (tourActuel === 'blanc') ? 'noir' : 'blanc';
                indicateurTour.innerText = tourActuel.toUpperCase() + "S";
                indicateurTour.style.color = (tourActuel === 'blanc') ? '#00d4ff' : '#ff0055';
                
                // On affiche "IA R√©fl√©chit" seulement si ce n'est pas du PvP
                if(tourActuel === 'noir' && niveauDifficulte !== 'pvp') {
                    indicateurTour.innerHTML += " <small>(IA R√©fl√©chit...)</small>";
                }
            }

            function effectuerDeplacement(depart, arrivee) {
                const piece = depart.querySelector('.piece');
                const cible = arrivee.querySelector('.piece');
                
                if (cible && cible.getAttribute('data-type') === 'roi') {
                    declencherVictoire();
                    arrivee.innerHTML = ''; 
                    arrivee.appendChild(piece); 
                    return;
                }

                if (arrivee.firstChild) arrivee.innerHTML = ''; 
                arrivee.appendChild(piece);
                
                arrivee.animate([ { transform: 'scale(1.2)' }, { transform: 'scale(1)' } ], { duration: 200 });
            }

            function declencherVictoire() {
                jeuFini = true;
                ecranVictoire.style.display = 'flex'; 
                if (tourActuel === 'blanc') {
                    texteVictoire.innerText = "LES BLANCS GAGNENT !";
                    texteVictoire.style.color = "#00d4ff"; 
                } else {
                    texteVictoire.innerText = (niveauDifficulte === 'pvp') ? "LES NOIRS GAGNENT !" : "GEMINI A GAGN√â !";
                    texteVictoire.style.color = "#ff0055"; 
                }
            }

            function estCoupValide(depart, arrivee) {
                const pieceDiv = depart.querySelector('.piece');
                if (!pieceDiv) return false;
                
                const type = pieceDiv.getAttribute('data-type');
                const couleur = pieceDiv.getAttribute('data-couleur');
                const pos1 = getCoords(depart);
                const pos2 = getCoords(arrivee);
                const dx = pos2.x - pos1.x; const dy = pos2.y - pos1.y; 
                const absDx = Math.abs(dx); const absDy = Math.abs(dy);
                const ciblePiece = arrivee.querySelector('.piece');

                if (ciblePiece && ciblePiece.getAttribute('data-couleur') === couleur) return false;

                if (type === 'pion') {
                    const dir = (couleur === 'blanc') ? -1 : 1; 
                    const startRow = (couleur === 'blanc') ? 6 : 1;
                    if (dx === 0 && dy === dir && !ciblePiece) return true;
                    if (dx === 0 && dy === 2 * dir && pos1.y === startRow && !ciblePiece && !getCaseAt(pos1.x, pos1.y + dir).querySelector('.piece')) return true;
                    if (absDx === 1 && dy === dir && ciblePiece) return true;
                    return false;
                }
                if (type === 'tour') return (dx === 0 || dy === 0) && checkCheminLibre(pos1, pos2);
                if (type === 'fou') return (absDx === absDy) && checkCheminLibre(pos1, pos2);
                if (type === 'reine') return ((dx === 0 || dy === 0) || (absDx === absDy)) && checkCheminLibre(pos1, pos2);
                if (type === 'cavalier') return (absDx === 2 && absDy === 1) || (absDx === 1 && absDy === 2);
                if (type === 'roi') return absDx <= 1 && absDy <= 1;
                return false;
            }

            /* =========================================
               3. MANAGER D'IA
               ========================================= */

            function jouerIA_Manager() {
                if (jeuFini) return;
                iaReflechit = true;

                // Heuristique simple pour le mode Normal/Difficile (tri des coups)
                let tousLesCoups = [];
                
                cases.forEach((tdDepart, indexDepart) => {
                    const piece = tdDepart.querySelector('.piece');
                    if (piece && piece.getAttribute('data-couleur') === 'noir') {
                        cases.forEach((tdArrivee, indexArrivee) => {
                            if (estCoupValide(tdDepart, tdArrivee)) {
                                let valeurPrise = 0;
                                const cible = tdArrivee.querySelector('.piece');
                                if (cible) {
                                    const t = cible.getAttribute('data-type');
                                    if (t === 'reine') valeurPrise = 9;
                                    else if (t === 'tour') valeurPrise = 5;
                                    else if (t === 'fou' || t === 'cavalier') valeurPrise = 3;
                                    else if (t === 'pion') valeurPrise = 1;
                                    else if (t === 'roi') valeurPrise = 1000;
                                }
                                tousLesCoups.push({
                                    id: tousLesCoups.length,
                                    departIndex: indexDepart,
                                    arriveeIndex: indexArrivee,
                                    notation: `${getNotation(indexDepart)}${getNotation(indexArrivee)}`,
                                    valeur: valeurPrise
                                });
                            }
                        });
                    }
                });

                if (tousLesCoups.length === 0) {
                    console.log("Aucun coup possible (Pat/Mat)");
                    iaReflechit = false;
                    return;
                }

                // D√âCISION
                const fenActuel = genererFEN();

                if (niveauDifficulte === 'facile') {
                    jouerCoupAuHasard(tousLesCoups);
                } 
                else if (niveauDifficulte === 'normal') {
                    const coupsInteressants = tousLesCoups.filter(c => c.valeur > 0);
                    if (coupsInteressants.length > 0 && Math.random() > 0.3) {
                        coupsInteressants.sort((a,b) => b.valeur - a.valeur);
                        executerCoup(coupsInteressants[0]);
                    } else {
                        jouerCoupAuHasard(tousLesCoups);
                    }
                } 
                else {
                    // Difficile & Extr√™me
                    jouerIA_Gemini_Pro(tousLesCoups, fenActuel);
                }
            }

            async function jouerIA_Gemini_Pro(moves, fen) {
                const moveListString = moves.map((m, i) => `${i}:${m.notation}`).join(", ");
                let promptSystem = "";
                
                if (niveauDifficulte === 'difficile') {
                    promptSystem = `Tu es un moteur d'√©checs interm√©diaire. FEN: ${fen}.
                    Coups possibles (ID:Notation) : [${moveListString}].
                    Joue positionnel. √âvite les blunders.
                    R√©ponds UNIQUEMENT l'ID du coup (chiffre).`;
                } else {
                    promptSystem = `Tu es un moteur Grand Ma√Ætre (Stockfish). FEN: ${fen}.
                    Coups possibles (ID:Notation) : [${moveListString}].
                    Sois agressif, cherche le mat.
                    R√©ponds UNIQUEMENT l'ID du coup (chiffre).`;
                }

                try {
                    const response = await fetch(GEMINI_URL, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ contents: [{ parts: [{ text: promptSystem }] }] })
                    });
                    const data = await response.json();
                    let idChoisi = -1;
                    if (data.candidates && data.candidates[0].content) {
                        const text = data.candidates[0].content.parts[0].text.trim();
                        const match = text.match(/\d+/);
                        if (match) idChoisi = parseInt(match[0]);
                    }
                    if (idChoisi !== -1 && idChoisi < moves.length) {
                        executerCoup(moves[idChoisi]);
                    } else {
                        moves.sort((a,b) => b.valeur - a.valeur);
                        executerCoup(moves[0]);
                    }
                } catch (e) {
                    console.error(e);
                    jouerCoupAuHasard(moves);
                }
            }

            function jouerCoupAuHasard(coups) {
                const randomCoup = coups[Math.floor(Math.random() * coups.length)];
                executerCoup(randomCoup);
            }

            function executerCoup(coup) {
                const caseD = cases[coup.departIndex];
                const caseA = cases[coup.arriveeIndex];
                caseD.style.backgroundColor = "rgba(255, 0, 85, 0.6)";
                caseA.style.backgroundColor = "rgba(255, 0, 85, 0.6)";
                setTimeout(() => {
                    caseD.style.backgroundColor = "";
                    caseA.style.backgroundColor = "";
                    effectuerDeplacement(caseD, caseA);
                    changerTour();
                    iaReflechit = false;
                }, 600);
            }
        });
    </script>
</body>
</html>
